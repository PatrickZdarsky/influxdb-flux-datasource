define(["react","lodash","prismjs","slate","slate-plain-serializer","app/core/utils/datemath","app/core/app_events","app/plugins/sdk","app/core/core_module","react-dom","@grafana/slate-react"],(function(e,t,n,r,i,o,a,s,u,l,c){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=30)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var r=n(17),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){var r=n(6).Symbol;e.exports=r},function(e,t){e.exports=o},function(e,t,n){var r,i,o;
/* @license
Papa Parse
v5.1.0
https://github.com/mholt/PapaParse
License: MIT
*/i=[],void 0===(o="function"==typeof(r=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,r=n&&/blob:/i.test((t.location||{}).protocol),i={},o=0,a={parse:function(n,r){var s=(r=r||{}).dynamicTyping||!1;if(x(s)&&(r.dynamicTypingFunction=s,s={}),r.dynamicTyping=s,r.transform=!!x(r.transform)&&r.transform,r.worker&&a.WORKERS_SUPPORTED){var u=function(){if(!a.WORKERS_SUPPORTED)return!1;var n,r,s=(n=t.URL||t.webkitURL||null,r=e.toString(),a.BLOB_URL||(a.BLOB_URL=n.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),u=new t.Worker(s);return u.onmessage=y,u.id=o++,i[u.id]=u}();return u.userStep=r.step,u.userChunk=r.chunk,u.userComplete=r.complete,u.userError=r.error,r.step=x(r.step),r.chunk=x(r.chunk),r.complete=x(r.complete),r.error=x(r.error),delete r.worker,void u.postMessage({input:n,config:r,workerId:u.id})}var p=null;return a.NODE_STREAM_INPUT,"string"==typeof n?p=r.download?new l(r):new f(r):!0===n.readable&&x(n.read)&&x(n.on)?p=new d(r):(t.File&&n instanceof File||n instanceof Object)&&(p=new c(r)),p.stream(n)},unparse:function(e,t){var n=!1,r=!0,i=",",o="\r\n",s='"',u=s+s,l=!1,c=null;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+s)}}();var f=new RegExp(h(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,l);if("object"==typeof e[0])return p(c||d(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:d(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function d(e){if("object"!=typeof e)return[];var t=[];for(var n in e)t.push(n);return t}function p(e,t,n){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(s&&r){for(var l=0;l<e.length;l++)0<l&&(a+=i),a+=m(e[l],l);0<t.length&&(a+=o)}for(var c=0;c<t.length;c++){var f=s?e.length:t[c].length,d=!1,p=s?0===Object.keys(t[c]).length:0===t[c].length;if(n&&!s&&(d="greedy"===n?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===n&&s){for(var h=[],y=0;y<f;y++){var g=u?e[y]:y;h.push(t[c][g])}d=""===h.join("").trim()}if(!d){for(var v=0;v<f;v++){0<v&&!p&&(a+=i);var b=s&&u?e[v]:v;a+=m(t[c][b],v)}c<t.length-1&&(!n||0<f&&!p)&&(a+=o)}}return a}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=e.toString().replace(f,u);return"boolean"==typeof n&&n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(r,a.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1)?s+r+s:r}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!n&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=m,a.ParserHandle=p,a.NetworkStreamer=l,a.FileStreamer=c,a.StringStreamer=f,a.ReadableStreamStreamer=d,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var n=e.config||{},r=[];return this.each((function(e){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:s.extend({},n)})})),i(),this;function i(){if(0!==r.length){var t,n,i,u=r[0];if(x(e.before)){var l=e.before(u.file,u.inputElem);if("object"==typeof l){if("abort"===l.action)return t=u.file,n=u.inputElem,i=l.reason,void(x(e.error)&&e.error({name:"AbortError"},t,n,i));if("skip"===l.action)return void o();"object"==typeof l.config&&(u.instanceConfig=s.extend(u.instanceConfig,l.config))}else if("skip"===l)return void o()}var c=u.instanceConfig.complete;u.instanceConfig.complete=function(e){x(c)&&c(e,u.file,u.inputElem),o()},a.parse(u.file,u.instanceConfig)}else x(e.complete)&&e.complete()}function o(){r.splice(0,1),i()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new p(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&x(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=s.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),s&&s.data&&(this._rowCount+=s.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:s,workerId:a.WORKER_ID,finished:l});else if(x(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!l||!x(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){x(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function l(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=A(this._chunkLoaded,this),t.onerror=A(this._chunkError,this)),t.open("GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{t.send()}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substr(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function c(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),u.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=A(this._chunkLoaded,this),t.onerror=A(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var i=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,i)}var o=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,n=e?t.substr(0,e):t;return t=e?t.substr(e):"",this._finished=!t,this.parseChunk(n)}}}function d(e){u.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=A((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=A((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=A((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=A((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function p(e){var t,n,r,i=Math.pow(2,53),o=-i,s=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,u=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,l=this,c=0,f=0,d=!1,p=!1,y=[],g={data:[],errors:[],meta:{}};if(x(e.step)){var v=e.step;e.step=function(t){if(g=t,E())k();else{if(k(),0===g.data.length)return;c+=t.data.length,e.preview&&c>e.preview?n.abort():v(g,l)}}}function A(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function k(){if(g&&r&&(w("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines)for(var t=0;t<g.data.length;t++)A(g.data[t])&&g.data.splice(t--,1);return E()&&function(){if(g)if(Array.isArray(g.data[0])){for(var t=0;E()&&t<g.data.length;t++)g.data[t].forEach(n);g.data.splice(0,1)}else g.data.forEach(n);function n(t){x(e.transformHeader)&&(t=e.transformHeader(t)),y.push(t)}}(),function(){if(!g||!e.header&&!e.dynamicTyping&&!e.transform)return g;function t(t,n){var r,i=e.header?{}:[];for(r=0;r<t.length;r++){var o=r,a=t[r];e.header&&(o=r>=y.length?"__parsed_extra":y[r]),e.transform&&(a=e.transform(a,o)),a=_(o,a),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(a)):i[o]=a}return e.header&&(r>y.length?w("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+r,f+n):r<y.length&&w("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+r,f+n)),i}var n=1;return!g.data.length||Array.isArray(g.data[0])?(g.data=g.data.map(t),n=g.data.length):g.data=t(g.data,0),e.header&&g.meta&&(g.meta.fields=y),f+=n,g}()}function E(){return e.header&&0===y.length}function _(t,n){return r=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[r]&&(e.dynamicTyping[r]=e.dynamicTypingFunction(r)),!0===(e.dynamicTyping[r]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(s.test(e)){var t=parseFloat(e);if(o<t&&t<i)return!0}return!1}(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n;var r}function w(e,t,n,r){g.errors.push({type:e,code:t,message:n,row:r})}this.parse=function(i,o,s){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substr(0,1048576);var n=new RegExp(h(t)+"([^]*?)"+h(t),"gm"),r=(e=e.replace(n,"")).split("\r"),i=e.split("\n"),o=1<i.length&&i[0].length<r[0].length;if(1===r.length||o)return"\n";for(var a=0,s=0;s<r.length;s++)"\n"===r[s][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(i,u)),r=!1,e.delimiter)x(e.delimiter)&&(e.delimiter=e.delimiter(i),g.meta.delimiter=e.delimiter);else{var l=function(t,n,r,i,o){var s,u,l,c;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var f=0;f<o.length;f++){var d=o[f],p=0,h=0,y=0;l=void 0;for(var g=new m({comments:i,delimiter:d,newline:n,preview:10}).parse(t),v=0;v<g.data.length;v++)if(r&&A(g.data[v]))y++;else{var b=g.data[v].length;h+=b,void 0!==l?0<b&&(p+=Math.abs(b-l),l=b):l=b}0<g.data.length&&(h/=g.data.length-y),(void 0===u||p<=u)&&(void 0===c||c<h)&&1.99<h&&(u=p,s=d,c=h)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);l.successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),g.meta.delimiter=e.delimiter}var c=b(e);return e.preview&&e.header&&c.preview++,t=i,n=new m(c),g=n.parse(t,o,s),k(),d?{meta:{paused:!0}}:g||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,n.abort(),t=t.substr(n.getCharIndex())},this.resume=function(){l.streamer._halted?(d=!1,l.streamer.parseChunk(t,!0)):setTimeout(this.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,n.abort(),g.meta.aborted=!0,x(e.complete)&&e.complete(g),t=""}}function h(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,n=(e=e||{}).delimiter,r=e.newline,i=e.comments,o=e.step,s=e.preview,u=e.fastMode,l=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(l=e.escapeChar),("string"!=typeof n||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=","),i===n)throw new Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<a.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var c=0,f=!1;this.parse=function(e,a,d){if("string"!=typeof e)throw new Error("Input must be a string");var p=e.length,m=n.length,y=r.length,g=i.length,v=x(o),b=[],A=[],k=[],E=c=0;if(!e)return F();if(u||!1!==u&&-1===e.indexOf(t)){for(var _=e.split(r),w=0;w<_.length;w++){if(k=_[w],c+=k.length,w!==_.length-1)c+=r.length;else if(d)return F();if(!i||k.substr(0,g)!==i){if(v){if(b=[],D(k.split(n)),L(),f)return F()}else D(k.split(n));if(s&&s<=w)return b=b.slice(0,s),F(!0)}}return F()}for(var C=e.indexOf(n,c),S=e.indexOf(r,c),q=new RegExp(h(l)+h(t),"g"),B=e.indexOf(t,c);;)if(e[c]!==t)if(i&&0===k.length&&e.substr(c,g)===i){if(-1===S)return F();c=S+y,S=e.indexOf(r,c),C=e.indexOf(n,c)}else{if(-1!==C&&(C<S||-1===S)){if(!(C<B)){k.push(e.substring(c,C)),c=C+m,C=e.indexOf(n,c);continue}var T=z(C,B,S);if(T&&void 0!==T.nextDelim){C=T.nextDelim,B=T.quoteSearch,k.push(e.substring(c,C)),c=C+m,C=e.indexOf(n,c);continue}}if(-1===S)break;if(k.push(e.substring(c,S)),M(S+y),v&&(L(),f))return F();if(s&&b.length>=s)return F(!0)}else for(B=c,c++;;){if(-1===(B=e.indexOf(t,B+1)))return d||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:c}),I();if(B===p-1)return I(e.substring(c,B).replace(q,t));if(t!==l||e[B+1]!==l){if(t===l||0===B||e[B-1]!==l){var R=j(-1===S?C:Math.min(C,S));if(e[B+1+R]===n){k.push(e.substring(c,B).replace(q,t)),e[c=B+1+R+m]!==t&&(B=e.indexOf(t,c)),C=e.indexOf(n,c),S=e.indexOf(r,c);break}var O=j(S);if(e.substr(B+1+O,y)===r){if(k.push(e.substring(c,B).replace(q,t)),M(B+1+O+y),C=e.indexOf(n,c),B=e.indexOf(t,c),v&&(L(),f))return F();if(s&&b.length>=s)return F(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:c}),B++}}else B++}return I();function D(e){b.push(e),E=c}function j(t){var n=0;if(-1!==t){var r=e.substring(B+1,t);r&&""===r.trim()&&(n=r.length)}return n}function I(t){return d||(void 0===t&&(t=e.substr(c)),k.push(t),c=p,D(k),v&&L()),F()}function M(t){c=t,D(k),k=[],S=e.indexOf(r,c)}function F(e,t){return{data:t?b[0]:b,errors:A,meta:{delimiter:n,linebreak:r,aborted:f,truncated:!!e,cursor:E+(a||0)}}}function L(){o(F(void 0,!0)),b=[],A=[]}function z(r,i,o){var a={nextDelim:void 0,quoteSearch:void 0},s=e.indexOf(t,i+1);if(i<r&&r<s&&(s<o||-1===o)){var u=e.indexOf(n,s);if(-1===u)return a;s<u&&(s=e.indexOf(t,s+1)),a=z(u,s,o)}else a={nextDelim:r,quoteSearch:i};return a}},this.abort=function(){f=!0},this.getCharIndex=function(){return c}}function y(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){r=!0,g(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(x(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},o),!r);a++);delete t.results}else x(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!r&&g(t.workerId,t.results)}function g(e,t){var n=i[e];x(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function v(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=b(e[n]);return t}function A(e,t){return function(){e.apply(t,arguments)}}function x(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var n=e.data;if(void 0===a.WORKER_ID&&n&&(a.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var r=a.parse(n.input,n.config);r&&t.postMessage({workerId:a.WORKER_ID,results:r,finished:!0})}}),(l.prototype=Object.create(u.prototype)).constructor=l,(c.prototype=Object.create(u.prototype)).constructor=c,(f.prototype=Object.create(f.prototype)).constructor=f,(d.prototype=Object.create(u.prototype)).constructor=d,a})?r.apply(t,i):r)||(e.exports=o)},function(e,t){e.exports=a},function(e,t){e.exports=s},function(e,t){e.exports=u},function(e,t){e.exports=l},function(e,t){e.exports=c},function(e,t,n){var r=n(5),i=n(16),o=n(19),a="Expected a function",s=Math.max,u=Math.min;e.exports=function(e,t,n){var l,c,f,d,p,h,m=0,y=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError(a);function b(t){var n=l,r=c;return l=c=void 0,m=t,d=e.apply(r,n)}function A(e){var n=e-h;return void 0===h||n>=t||n<0||g&&e-m>=f}function x(){var e=i();if(A(e))return k(e);p=setTimeout(x,function(e){var n=t-(e-h);return g?u(n,f-(e-m)):n}(e))}function k(e){return p=void 0,v&&l?b(e):(l=c=void 0,d)}function E(){var e=i(),n=A(e);if(l=arguments,c=this,h=e,n){if(void 0===p)return function(e){return m=e,p=setTimeout(x,t),y?b(e):d}(h);if(g)return clearTimeout(p),p=setTimeout(x,t),b(h)}return void 0===p&&(p=setTimeout(x,t)),d}return t=o(t)||0,r(n)&&(y=!!n.leading,f=(g="maxWait"in n)?s(o(n.maxWait)||0,t):f,v="trailing"in n?!!n.trailing:v),E.cancel=function(){void 0!==p&&clearTimeout(p),m=0,l=h=c=p=void 0},E.flush=function(){return void 0===p?d:k(i())},E}},function(e,t,n){var r=n(6);e.exports=function(){return r.Date.now()}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(18))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(5),i=n(20),o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return o;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=u.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):s.test(e)?o:+e}},function(e,t,n){var r=n(21),i=n(24),o="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||i(e)&&r(e)==o}},function(e,t,n){var r=n(7),i=n(22),o=n(23),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?s:a:u&&u in Object(e)?i(e):o(e)}},function(e,t,n){var r=n(7),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(26);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(28)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(27)(!0)).push([e.i,".slate-query-field {\n  font-size: 14px;\n  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\n  height: auto; }\n\n.slate-query-field-wrapper {\n  position: relative;\n  display: inline-block;\n  padding: 6px 7px 4px;\n  width: 100%;\n  cursor: text;\n  line-height: 1.5;\n  color: #767980;\n  background-color: #fff;\n  background-image: none;\n  border: solid 1px #dde4ed;\n  border-radius: 3px;\n  transition: all 0.3s; }\n\n.slate-typeahead .typeahead {\n  position: absolute;\n  z-index: auto;\n  top: -10000px;\n  left: -10000px;\n  opacity: 0;\n  border-radius: 3px;\n  transition: opacity 0.75s;\n  border: solid 1px #dde4ed;\n  max-height: calc(66vh);\n  overflow-y: scroll;\n  max-width: calc(66%);\n  overflow-x: hidden;\n  outline: none;\n  list-style: none;\n  background: #fff;\n  color: #52545c;\n  transition: opacity 0.4s ease-out;\n  box-shadow: 0 5px 10px 0 #dde4ed; }\n\n.slate-typeahead .typeahead-group__title {\n  color: #767980;\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 8px 10px; }\n\n.slate-typeahead .typeahead-item {\n  height: auto;\n  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\n  padding: 8px 10px;\n  padding-left: 20px;\n  font-size: 12px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  z-index: 1;\n  display: block;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1); }\n\n.slate-typeahead .typeahead-item__selected {\n  background-color: #d7effc;\n  color: #0083b3; }\n\n.slate-typeahead .typeahead-item__selected .typeahead-item-hint {\n  font-size: 10px;\n  color: #52545c; }\n\n/* SYNTAX */\n.slate-query-field .token.comment,\n.slate-query-field .token.block-comment,\n.slate-query-field .token.prolog,\n.slate-query-field .token.doctype,\n.slate-query-field .token.cdata {\n  color: #767980; }\n\n.slate-query-field .token.punctuation {\n  color: #767980; }\n\n.slate-query-field .token.property,\n.slate-query-field .token.tag,\n.slate-query-field .token.boolean,\n.slate-query-field .token.number,\n.slate-query-field .token.function-name,\n.slate-query-field .token.constant,\n.slate-query-field .token.symbol,\n.slate-query-field .token.deleted {\n  color: #d44939; }\n\n.slate-query-field .token.selector,\n.slate-query-field .token.attr-name,\n.slate-query-field .token.string,\n.slate-query-field .token.char,\n.slate-query-field .token.function,\n.slate-query-field .token.builtin,\n.slate-query-field .token.inserted {\n  color: #3aa655; }\n\n.slate-query-field .token.operator,\n.slate-query-field .token.entity,\n.slate-query-field .token.url,\n.slate-query-field .token.variable {\n  color: #9954bb; }\n\n.slate-query-field .token.atrule,\n.slate-query-field .token.attr-value,\n.slate-query-field .token.keyword,\n.slate-query-field .token.class-name {\n  color: #0083b3; }\n\n.slate-query-field .token.regex,\n.slate-query-field .token.important {\n  color: #ff7941; }\n\n.slate-query-field .token.important {\n  font-weight: normal; }\n\n.slate-query-field .token.bold {\n  font-weight: bold; }\n\n.slate-query-field .token.italic {\n  font-style: italic; }\n\n.slate-query-field .token.entity {\n  cursor: help; }\n\n.slate-query-field .namespace {\n  opacity: 0.7; }\n","",{version:3,sources:["styles.css"],names:[],mappings:"AAAA;EACE,eAAe;EACf,8DAA8D;EAC9D,YAAY,EAAE;;AAEhB;EACE,kBAAkB;EAClB,qBAAqB;EACrB,oBAAoB;EACpB,WAAW;EACX,YAAY;EACZ,gBAAgB;EAChB,cAAc;EACd,sBAAsB;EACtB,sBAAsB;EACtB,yBAAyB;EACzB,kBAAkB;EAClB,oBAAoB,EAAE;;AAExB;EACE,kBAAkB;EAClB,aAAa;EACb,aAAa;EACb,cAAc;EACd,UAAU;EACV,kBAAkB;EAClB,yBAAyB;EACzB,yBAAyB;EACzB,sBAAsB;EACtB,kBAAkB;EAClB,oBAAoB;EACpB,kBAAkB;EAClB,aAAa;EACb,gBAAgB;EAChB,gBAAgB;EAChB,cAAc;EACd,iCAAiC;EACjC,gCAAgC,EAAE;;AAEpC;EACE,cAAc;EACd,eAAe;EACf,gBAAgB;EAChB,iBAAiB,EAAE;;AAErB;EACE,YAAY;EACZ,8DAA8D;EAC9D,iBAAiB;EACjB,kBAAkB;EAClB,eAAe;EACf,uBAAuB;EACvB,gBAAgB;EAChB,UAAU;EACV,cAAc;EACd,mBAAmB;EACnB,eAAe;EACf,6NAA6N,EAAE;;AAEjO;EACE,yBAAyB;EACzB,cAAc,EAAE;;AAElB;EACE,eAAe;EACf,cAAc,EAAE;;AAElB,WAAW;AACX;;;;;EAKE,cAAc,EAAE;;AAElB;EACE,cAAc,EAAE;;AAElB;;;;;;;;EAQE,cAAc,EAAE;;AAElB;;;;;;;EAOE,cAAc,EAAE;;AAElB;;;;EAIE,cAAc,EAAE;;AAElB;;;;EAIE,cAAc,EAAE;;AAElB;;EAEE,cAAc,EAAE;;AAElB;EACE,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB,EAAE;;AAEtB;EACE,YAAY,EAAE;;AAEhB;EACE,YAAY,EAAE",file:"styles.css",sourcesContent:[".slate-query-field {\n  font-size: 14px;\n  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\n  height: auto; }\n\n.slate-query-field-wrapper {\n  position: relative;\n  display: inline-block;\n  padding: 6px 7px 4px;\n  width: 100%;\n  cursor: text;\n  line-height: 1.5;\n  color: #767980;\n  background-color: #fff;\n  background-image: none;\n  border: solid 1px #dde4ed;\n  border-radius: 3px;\n  transition: all 0.3s; }\n\n.slate-typeahead .typeahead {\n  position: absolute;\n  z-index: auto;\n  top: -10000px;\n  left: -10000px;\n  opacity: 0;\n  border-radius: 3px;\n  transition: opacity 0.75s;\n  border: solid 1px #dde4ed;\n  max-height: calc(66vh);\n  overflow-y: scroll;\n  max-width: calc(66%);\n  overflow-x: hidden;\n  outline: none;\n  list-style: none;\n  background: #fff;\n  color: #52545c;\n  transition: opacity 0.4s ease-out;\n  box-shadow: 0 5px 10px 0 #dde4ed; }\n\n.slate-typeahead .typeahead-group__title {\n  color: #767980;\n  font-size: 12px;\n  line-height: 1.5;\n  padding: 8px 10px; }\n\n.slate-typeahead .typeahead-item {\n  height: auto;\n  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;\n  padding: 8px 10px;\n  padding-left: 20px;\n  font-size: 12px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  z-index: 1;\n  display: block;\n  white-space: nowrap;\n  cursor: pointer;\n  transition: color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1); }\n\n.slate-typeahead .typeahead-item__selected {\n  background-color: #d7effc;\n  color: #0083b3; }\n\n.slate-typeahead .typeahead-item__selected .typeahead-item-hint {\n  font-size: 10px;\n  color: #52545c; }\n\n/* SYNTAX */\n.slate-query-field .token.comment,\n.slate-query-field .token.block-comment,\n.slate-query-field .token.prolog,\n.slate-query-field .token.doctype,\n.slate-query-field .token.cdata {\n  color: #767980; }\n\n.slate-query-field .token.punctuation {\n  color: #767980; }\n\n.slate-query-field .token.property,\n.slate-query-field .token.tag,\n.slate-query-field .token.boolean,\n.slate-query-field .token.number,\n.slate-query-field .token.function-name,\n.slate-query-field .token.constant,\n.slate-query-field .token.symbol,\n.slate-query-field .token.deleted {\n  color: #d44939; }\n\n.slate-query-field .token.selector,\n.slate-query-field .token.attr-name,\n.slate-query-field .token.string,\n.slate-query-field .token.char,\n.slate-query-field .token.function,\n.slate-query-field .token.builtin,\n.slate-query-field .token.inserted {\n  color: #3aa655; }\n\n.slate-query-field .token.operator,\n.slate-query-field .token.entity,\n.slate-query-field .token.url,\n.slate-query-field .token.variable {\n  color: #9954bb; }\n\n.slate-query-field .token.atrule,\n.slate-query-field .token.attr-value,\n.slate-query-field .token.keyword,\n.slate-query-field .token.class-name {\n  color: #0083b3; }\n\n.slate-query-field .token.regex,\n.slate-query-field .token.important {\n  color: #ff7941; }\n\n.slate-query-field .token.important {\n  font-weight: normal; }\n\n.slate-query-field .token.bold {\n  font-weight: bold; }\n\n.slate-query-field .token.italic {\n  font-style: italic; }\n\n.slate-query-field .token.entity {\n  cursor: help; }\n\n.slate-query-field .namespace {\n  opacity: 0.7; }\n"]}])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}var a,s,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var s=e[a];null!=s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},function(e,t,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=s.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),l=null,c=0,f=[],d=n(29);function p(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(b(r.parts[a],t))}else{var s=[];for(a=0;a<r.parts.length;a++)s.push(b(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:s}}}}function h(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function m(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),f.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=u(e.insertAt.before,n);n.insertBefore(t,i)}}function y(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return v(t,e.attrs),m(e,t),t}function v(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function b(e,t){var n,r,i,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var a=c++;n=l||(l=g(t)),r=k.bind(null,n,a,!1),i=k.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),m(e,t),t}(t),r=_.bind(null,n,t),i=function(){y(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(t),r=E.bind(null,n),i=function(){y(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=h(e,t);return p(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(s=o[a.id]).refs--,r.push(s)}e&&p(h(e,t),t);for(i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete o[s.id]}}}};var A,x=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function k(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function E(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function _(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=d(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t,n){"use strict";n.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var f=n(1),d=n.n(f),p=n(8),h=n(9),m=function(e){return e&&"_"!==e[0]&&"result"!==e&&"table"!==e},y=["result","","table"],g=function(e){return Object.keys(e).filter((function(e){return"_"!==e[0]})).filter((function(e){return-1===y.indexOf(e)})).reduce((function(t,n){return t[n]=e[n],t}),{})},v=function(e){var t=[e._measurement,e._field],n=g(e);return c(t,Object.keys(n).map((function(e){return e+"="+n[e]}))).join(" ")},b=function(e){var t=Object(h.parse)(e,{header:!0,comments:"#"});return{data:t.data,types:function(e,t){var n={};if("#"===e[0]){var r=e.split("\n")[0].slice(1).split(",");r.length===t.fields.length&&t.fields.forEach((function(e,t){n[e]=r[t].trim()}))}return n}(e,t.meta)}},A=function(e){var t=parseFloat(e);return isNaN(t)?null:t},x=function(e,t){var n=e;if(t)try{switch(t){case"float":case"double":n=parseFloat(e);break;case"integer":case"long":n=parseInt(e,10)}}catch(e){console.error(e)}return n},k=function(e){return Date.parse(e)};function E(e){return e.trim().split(/\n\s*\s/)}function _(e){var t=b(e),n=t.data,r=t.types,i={type:"table",columns:[],rows:[]};if(n.length>0){var o=[{text:"Time",id:"_time"},{text:"Measurement",id:"_measurement"},{text:"Field",id:"_field"}],a=n[0],s=Object.keys(a).filter(m).map((function(e){return{id:e,text:e}})),u=c(o,s,[{id:"_value",text:"Value"}]);u.forEach((function(e){return i.columns.push(e)})),i.rows=n.map((function(e){return u.map((function(t,n){var i=e[t.id];return n>=o.length&&r[t.id]&&(i=x(e[t.id],r[t.id])),i}))}))}return i}function w(e){return void 0!==e._time?e._time:void 0!==e._start?e._start:void 0}function C(e){var t=b(e).data;if(0===t.length)return[];var n=f.groupBy(t,"table");return Object.keys(n).map((function(e){return n[e]})).map((function(e){return{datapoints:e.map((function(e){return[A(e._value),k(w(e))]})),target:v(e[0])}}))}function S(e){return b(e).data.map((function(e){return e._value}))}var q=/^\s*measurements\((.+)\)\s*$/,B=/^\s*tags\((.+)\s*,\s*(.+)\)\s*$/,T=/^\s*tag_values\((.+)\s*,\s*(.+)\s*,\s*(.+)\)\s*$/,R=/^\s*field_keys\((.+)\s*,\s*(.+)\)\s*$/;function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var D=function(){function e(e,t,n){this.backendSrv=t,this.templateSrv=n,this.type="influxdb-flux",this.url=e.url.trim(),this.username=e.username,this.password=e.password,this.name=e.name,this.basicAuth=e.basicAuth,this.withCredentials=e.withCredentials,this.interval=(e.jsonData||{}).timeInterval,this.organization=(e.jsonData||{}).organization,this.bucket=(e.jsonData||{}).bucket,this.supportAnnotations=!0,this.supportMetrics=!0}return e.$inject=["instanceSettings","backendSrv","templateSrv"],e.prototype.prepareQueryTarget=function(e,t){var n=this.getTimeFilter(t);t.scopedVars.range={value:n};var r=this.templateSrv.replace(e.query,t.scopedVars,"pipe");return o(o({},e),{query:r})},e.prototype.query=function(e){var t=this,n=e.targets.filter((function(e){return e.query})).map((function(n){return t.prepareQueryTarget(n,e)}));if(0===n.length)return Promise.resolve({data:[]});var r=n.map((function(n){var r=n.query;return"table"===n.resultFormat?t._seriesQuery(r,e).then((function(e){return E(e.data)})).then((function(e){return e.map(_)})):t._seriesQuery(r,e).then((function(e){return E(e.data)})).then((function(e){return e.map(C)}))}));return Promise.all(r).then((function(e){return{data:d.a.flattenDeep(e).slice(0,120)}}))},e.prototype.annotationQuery=function(e){if(!e.annotation.query)return Promise.reject({message:"Query missing in annotation definition"});var t=e.annotation.query,n=o(o({scopedVars:{}},e),{silent:!0}),r=this.prepareQueryTarget({query:t},n);return this._seriesQuery(r.query,n).then((function(t){var n=E(t.data);if(0===n.length)throw{message:"No results in response from InfluxDB"};return d.a.flatten(n.map((function(t){return function(e,t){var n=b(e).data;if(0===n.length)return[];var r=[],i=t.textCol||"_value",o=(t.tagsCol||"").split(",").map((function(e){return e.trim()}));return n.forEach((function(e){var n=g(e),a=f.flatten(o.filter((function(e){return n[e]})).map((function(e){return n[e].split(",")})));r.push({annotation:t,time:k(e._time),tags:a,text:e[i]})})),r}(t,e.annotation)})))}))},e.prototype.metricFindQuery=function(e,t){var n=function(e){var t=e.match(q);if(t)return'import "influxdata/influxdb/v1" v1.measurements(bucket: "'+(i=t[1])+'")';var n=e.match(B);if(n)return'from(bucket:"'+(i=n[1])+'")\n    |> range($range)\n    |> filter(fn:(r) => r._measurement == "'+(o=n[2])+'")\n    |> keys()';var r=e.match(T);if(r){var i=r[1],o=r[2],a=r[3];return'from(bucket:"'+i+'")\n    |> range($range)\n    |> filter(fn:(r) => r._measurement == "'+o+'")\n    |> group(columns:["'+a+'"])\n    |> distinct(column:"'+a+'")'}var s=e.match(R);return s?'from(bucket:"'+(i=s[1])+'")\n    |> range($range)\n    |> filter(fn:(r) => r._measurement == "'+(o=s[2])+'")\n    |> group(columns:["_field"])\n    |> distinct(column:"_field")':e}(e),r={to:"now",from:"now - 1h"};t&&"object"===O(t)&&(t.range&&t.range.raw?r=t.range.raw:t.variable&&t.variable.timeSrv&&t.variable.timeSrv.time&&(r=t.variable.timeSrv.time));var i=o(o({rangeRaw:r,scopedVars:{}},t),{silent:!0}),a=this.prepareQueryTarget({query:n},i);return this._seriesQuery(a.query,i).then((function(e){var t=E(e.data);return d.a.uniq(d.a.flatten(t.map(S))).filter((function(e){return e&&"_"!==e[0]})).map((function(e){return{text:e}}))}))},e.prototype._seriesQuery=function(e,t){return e?this._influxRequest("POST","/api/v2/query",e,t):Promise.resolve({data:""})},e.prototype.testDatasource=function(){var e='from(bucket:"'+this.bucket+'")\n        |> range(start:-10y)\n        |> last()';return this._influxRequest("POST","/api/v2/query",e).then((function(e){return e&&e.data&&e.data.trim()?{status:"success",message:"Data source connected and database found."}:{status:"error",message:'Data source connected, but has no data. Verify the "bucket" field and make sure the bucket has data.'}})).catch((function(e){return{status:"error",message:e.message}}))},e.prototype._influxRequest=function(e,t,n,r){var i={};this.username&&(i.u=this.username,i.p=this.password);var o={method:e,url:this.url+"/flux"+t+"?org="+this.organization,params:i,data:n,precision:"ms",inspect:{type:this.type},headers:{Accept:"application/csv","Content-Type":"application/vnd.flux"}};return(this.basicAuth||this.withCredentials)&&(o.withCredentials=!0),this.basicAuth&&(o.headers.Authorization=this.basicAuth),this.backendSrv.datasourceRequest(o).then((function(e){return e}),(function(e){if(0!==e.status||e.status>=300)throw e.data&&e.data.error?{message:"InfluxDB Error: "+e.data.error,data:e.data,config:e.config}:{message:"Network Error: "+e.statusText+"("+e.status+")",data:e.data,config:e.config}}))},e.prototype.getTimeFilter=function(e){var t=this.getInfluxTime(e.rangeRaw.from,!1),n=this.getInfluxTime(e.rangeRaw.to,!0);return"now"===n?"start: "+t:"start: "+t+", stop: "+n},e.prototype.getInfluxTime=function(e,t){if(d.a.isString(e)){if("now"===e)return e;var n=/^now\s*-\s*(\d+)([d|h|m|s])$/.exec(e);if(n)return"-"+parseInt(n[1],10)+n[2];e=p.parse(e,t)}return e.toISOString()},e}(),j=n(10),I=n.n(j),M=n(11),F=n(0),L=n.n(F),z=n(12),U=n.n(z),N=n(4),P=n.n(N),Q=n(13),$=n.n(Q),K=n(3),W=n(14),Y={"[":"]","{":"}","(":")"};var H=n(2),V=n.n(H),J="prism-token";function X(e){var t=e.definition,n=e.language;return t&&(V.a.languages[n]=V.a.languages[n]||t),{renderDecoration:function(e,t,n){var r=e.children,i=e.decoration;if(i.type!==J)return n();var o="token "+i.data.get("types");return L.a.createElement("span",{className:o},r)},decorateNode:function(e,t,r){var i,o;if("paragraph"!==e.type)return[];var a=e.getTexts().toArray(),s=a.map((function(e){return e.text})).join("\n"),l=V.a.languages[n],c=V.a.tokenize(s,l),f=[],d=a.shift(),p=d,h=0,m=0,y=0;function g(t,n){var r,i,o=(n||"")+" "+(t.type||"")+" "+(t.alias||"");if("string"==typeof t||"string"==typeof t.content){d=p,h=m;var s="string"==typeof t?t:t.content,l=s.split("\n").length-1,c=s.length-l,v=y+c,b=d.text.length-h,A=c;for(m=h+A;b<A;)A=c-b,b=(p=a.shift()).text.length,m=A;if("string"!=typeof t||n){var x=e.createDecoration({anchor:{key:d.key,offset:h},focus:{key:p.key,offset:m},type:J,data:{types:o}});f.push(x)}y=v}else if(t.content&&t.content.length)try{for(var k=u(t.content),E=k.next();!E.done;E=k.next()){g(E.value,o)}}catch(e){r={error:e}}finally{try{E&&!E.done&&(i=k.return)&&i.call(k)}finally{if(r)throw r.error}}}try{for(var v=u(c),b=v.next();!b.done;b=v.next()){g(b.value)}}catch(e){i={error:e}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}return f}}}function G(e){var t=e.handler;return{onKeyDown:function(e,n,r){return t&&"Enter"===e.key&&!e.shiftKey?(e.preventDefault(),t(e),!0):r()}}}function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRef=function(e){t.el=e},t}return i(t,e),t.prototype.componentDidUpdate=function(e){this.props.isSelected&&!e.isSelected&&function(e){if(e&&e.offsetParent){var t=e.offsetParent;(e.offsetTop>t.scrollTop+t.offsetHeight||e.offsetTop<t.scrollTop)&&(t.scrollTop=e.offsetTop-t.offsetTop)}}(this.el)},t.prototype.render=function(){var e=this.props,t=e.hint,n=e.isSelected,r=e.label,i=e.onClickItem,o=e.editor,a=n?"typeahead-item typeahead-item__selected":"typeahead-item";return L.a.createElement("li",{ref:this.getRef,className:a,onClick:function(){return i(r,o)}},r,t&&n?L.a.createElement("div",{className:"typeahead-item-hint"},t):null)},t}(L.a.PureComponent),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.items,n=e.label,r=e.selected,i=e.onClickItem,o=e.editor;return L.a.createElement("li",{className:"typeahead-group"},L.a.createElement("div",{className:"typeahead-group__title"},n),L.a.createElement("ul",{className:"typeahead-group__list"},t.map((function(e){var t="object"===Z(e)?e.text:e,n="object"===Z(e)?e.display||e.text:e;return L.a.createElement(ee,{key:t,onClickItem:i,isSelected:r.indexOf(t)>-1,hint:e.hint,label:n,editor:o})}))))},t}(L.a.PureComponent),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.groupedItems,n=e.menuRef,r=e.selectedItems,i=e.onClickItem,a=e.editor;return L.a.createElement("ul",{className:"typeahead",ref:n},t.map((function(e){return L.a.createElement(te,o({key:e.label,onClickItem:i,selected:r,editor:a},e))})))},t}(L.a.PureComponent);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ie=function(e,t,n){return this.text=e,this.deleteBackwards=n||0,this.type=t||re(this.text),this};function oe(e){return e?e.reduce((function(e,t){return e.concat(t.items)}),[]):[]}var ae=function(e){var t=e.split("\n").map((function(e){return K.Block.create({type:"paragraph",nodes:[K.Text.create(e)]})}));return K.Document.create({nodes:t})},se=function(e){return K.Value.create({document:ae(e)})},ue=function(e){function t(t){var n=e.call(this,t)||this,r=t.index,i=void 0===r?0:r,o=t.prefix,a=void 0===o?"query":o;return n.node=document.createElement("div"),n.node.classList.add("slate-typeahead","slate-typeahead-"+a+"-"+i),document.body.appendChild(n.node),n}return i(t,e),t.prototype.componentWillUnmount=function(){document.body.removeChild(this.node)},t.prototype.render=function(){return $.a.createPortal(this.props.children,this.node)},t}(L.a.Component),le=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.onChange=function(e){var t=e.value.document!==r.state.value.document;r.setState({value:e.value},(function(){t&&r.handleChangeQuery()})),window.requestAnimationFrame(r.handleTypeahead)},r.onMetricsReceived=function(){var e,t,n,i;r.state.metrics&&(e=r.props.language,t="metrics",n=r.state.metrics,void 0===i&&(i="variable"),V.a.languages[e][t]={alias:i,pattern:new RegExp("(?:^|\\s)("+n.join("|")+")(?:$|\\s)")},window.requestAnimationFrame((function(){var e=r.state.value.change().insertText(" ").deleteBackward(1);r.onChange(e)})))},r.request=function(e){return r.props.request?r.props.request(e):fetch(e)},r.handleChangeQuery=function(){var e=r.props.onQueryChange;e&&e(P.a.serialize(r.state.value))},r.onKeyDown=function(e,t,n){var i=r.state,o=i.typeaheadIndex,a=i.suggestions,s=e;switch(s.key){case"Escape":if(r.menuEl)return s.preventDefault(),s.stopPropagation(),r.resetTypeahead(),!0;break;case" ":if(s.ctrlKey)return s.preventDefault(),r.handleTypeahead(),!0;break;case"Enter":case"Tab":if(r.menuEl){if(e.preventDefault(),!a||0===a.length)return n();var u=oe(a),l=u[Math.abs(o)%u.length||0];r.onChange(r.applyTypeahead(t,l))}break;case"ArrowDown":r.menuEl&&(e.preventDefault(),r.setState({typeaheadIndex:o+1}));break;case"ArrowUp":r.menuEl&&(e.preventDefault(),r.setState({typeaheadIndex:Math.max(0,o-1)}))}return n()},r.handleTypeahead=function(e,t){return e||r.state.value.change()},r.applyTypeahead=function(e,t){return r.editorEl()},r.resetTypeahead=function(){r.setState({suggestions:[],typeaheadIndex:0,typeaheadPrefix:"",typeaheadContext:null})},r.handleBlur=function(e,t,n){var i=r.props.onBlur;return r.resetTimer=setTimeout(r.resetTypeahead,500),i&&i(),n()},r.handleFocus=function(e,t,n){var i=r.props.onFocus;return i&&i(),n()},r.handleClickMenu=function(e,t){var n=r.applyTypeahead(t,new ie(e));r.onChange(n)},r.updateMenu=function(){var e=r.state.suggestions,t=r.menuEl;if(t){var n=window.getSelection();if(null!==n){var i=n.anchorNode;if(e&&e.length>0){if(i&&i.parentElement){var o=i.parentElement.getBoundingClientRect(),a=window.scrollX,s=window.scrollY;requestAnimationFrame((function(){t.style.opacity=1,t.style.top=o.top+s+o.height+4+"px",t.style.left=o.left+a-2+"px"}))}}else t.removeAttribute("style")}}},r.menuRef=function(e){r.menuEl=e},r.editorRef=function(e){r.editorEl=e},r.renderMenu=function(){var e=r.props.portalPrefix,t=r.state.suggestions;if(!(t&&t.length>0))return null;var n=Math.max(r.state.typeaheadIndex,0),i=oe(t);n=n%i.length||0;var o=(i.length>0?[i[n]]:[]).map((function(e){return"object"===re(e)?e.text:e}));return L.a.createElement(ue,{prefix:e},L.a.createElement(ne,{menuRef:r.menuRef,selectedItems:o,onClickItem:r.handleClickMenu,groupedItems:t,editor:r.editorEl}))};var i=t.prismDefinition,o=void 0===i?{}:i,a=t.prismLanguage,s=void 0===a?"promql":a;return r.plugins=[{onKeyDown:function(e,t,n){var r=t.value;switch(e.key){case"(":case"{":case"[":e.preventDefault();var i=r.selection,o=i.start,a=o.offset,s=o.key,u=i.end,l=u.offset,c=u.key,f=i.focus.offset,d=r.focusText.text;return r.selection.isExpanded?t.insertTextByKey(s,a,e.key).insertTextByKey(c,l+1,Y[e.key]).moveEndBackward(1):f===d.length||" "===d[f]||Object.values(Y).includes(d[f])?t.insertText(""+e.key+Y[e.key]).moveBackward(1):t.insertText(e.key),!0;case"Backspace":d=r.anchorText.text;var p=r.selection.anchor.offset,h=d[p-1],m=d[p];if(Y[h]&&Y[h]===m)return e.preventDefault(),t.deleteBackward(1).deleteForward(1).focus(),!0}return n()}},{onKeyDown:function(e,t,n){var r=t.value;if(r.selection.isExpanded)return n();if("k"===e.key&&e.ctrlKey){e.preventDefault();var i=r.anchorText.text,o=r.selection.anchor.offset,a=i.length-o;return t.deleteForward(a),!0}return n()}},G({handler:t.onPressEnter}),{onKeyDown:function(e,t,n){var r=t.value;if(r.selection.isExpanded)return n();if("Enter"===e.key&&e.shiftKey){e.preventDefault();var i=function(e){var t=e.length-e.trimStart().length;if(t){for(var n=e[0];--t;)n+=e[0];return n}return""}(r.startBlock.text);return t.splitBlock().insertText(i).focus()}return n()}},X({definition:o,language:s})],r.state={labelKeys:{},labelValues:{},metrics:t.metrics||[],suggestions:[],typeaheadIndex:0,typeaheadPrefix:"",value:se(t.initialQuery||"")},r}return i(t,e),t.prototype.componentDidMount=function(){this.updateMenu()},t.prototype.componentWillUnmount=function(){clearTimeout(this.resetTimer)},t.prototype.componentDidUpdate=function(){this.updateMenu()},t.prototype.componentWillReceiveProps=function(e){e.metrics&&e.metrics!==this.props.metrics&&this.setState({metrics:e.metrics},this.onMetricsReceived),null!==e.initialQuery&&e.initialQuery!==this.props.initialQuery&&this.setState({value:se(e.initialQuery)})},t.prototype.render=function(){return L.a.createElement("div",{className:"slate-query-field"},this.renderMenu(),L.a.createElement(W.Editor,{autoCorrect:!1,onBlur:this.handleBlur,onKeyDown:this.onKeyDown,onChange:this.onChange,onFocus:this.handleFocus,placeholder:this.props.placeholder,plugins:this.plugins,ref:this.editorRef,spellCheck:!1,value:this.state.value}))},t}(L.a.Component),ce=n(15),fe=n.n(ce);function de(e,t){for(var n,r=e.parentElement.previousSibling;r;){if(n=r.querySelector(t))return n;r=r.previousSibling}}"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,n=(this.document||this.ownerDocument).querySelectorAll(e),r=this;do{for(t=n.length;--t>=0&&n.item(t)!==r;);r=r.parentElement}while(t<0&&r);return r});var pe=[{text:"count",display:"count()",hint:"For each aggregated column, ouput the number of non-null records."},{text:"covariance",display:'covariance(columns: ["valA", "valB"])',hint:'Compute covariance between two columns and write it to "_value".'},{text:"derivative",display:"derivative()",hint:"Computes the time based difference between subsequent records"},{text:"difference",display:"difference()",hint:"Computes the difference between subsequent records."},{text:"distinct",display:'distinct(column: "host")',hint:"Produce unique values for a given column"},{text:"filter",display:'filter(fn: (r) => r["_value"] > 0)',hint:"Applies a predicate function to each input record, output tables contain only records that matched the predicate."},{text:"first",display:"first()",hint:"Selects the first non-null record from the input table."},{text:"from",display:'from(bucket: "database/policy")',hint:"Starting point of a query, produces a table from the given bucket."},{text:"group",display:'group(columns: ["host"], mode:"by") ',hint:"Groups results by a specified list of columns"},{text:"integral",display:"integral()",hint:"For each aggregate column, output the area under the curve."},{text:"join",display:'join(tables: {cpu: cpu, mem: mem}, on: ["host"])',hint:'Join two time series together on time and the list of "on" column keys.'},{text:"last",display:"last()",hint:"Selects the last non-null record from the input table."},{text:"limit",display:"limit(n: 10)",hint:'Limit the output table to the first "n" records of the input table. '},{text:"map",display:"map(fn: (r) => r)",hint:"Applies a function to each record of the input tables."},{text:"max",display:"max()",hint:"Selects the maximum record from the input table."},{text:"mean",display:"mean()",hint:"For each aggregated column, it outputs the mean as a float."},{text:"min",display:"min()",hint:"Selects the minimum record from the input table."},{text:"percentile",display:"percentile(percentile: 0.95)",hint:" For each aggregated column, it outputs the value that represents the specified percentile of the non-null record as a float."},{text:"range",display:"range($range)",hint:'Filters the results by time boundaries "start" and "stop". Use "$range" to apply the dashboard range.'},{text:"sample",display:"sample(n: 10)",hint:'Selects a every "n"-th record from the input table.'},{text:"set",display:'set(key: "myKey", value: "42")',hint:"Assigns a static value to each record"},{text:"shift",display:"shift(shift: +12h)",hint:"Add a fixed duration to time columns."},{text:"skew",display:"skew()",hint:"For each aggregated column, it outputs the skew as a float."},{text:"sort",display:'sort(cols: ["host", "value"], desc: true)',hint:"Sorts the results by the specified columns, default sort is ascending"},{text:"spread",display:"spread()",hint:"For each aggregated column, it outputs the difference between the min and max values."},{text:"stddev",display:"stddev()",hint:"For each aggregated column, it outputs the standard deviation as a float."},{text:"sum",display:"sum()",hint:"For each aggregated column, it outputs the sum of all records. "},{text:"window",display:"window(every: $__interval)",hint:"Partitions the results by a given time range."},{text:"yield",display:"yield()",hint:"Yield the input table as the result of the query."}],he={comment:{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0},"context-short":{pattern:/^\w+\.\.(\w+\.\.)?\w*$/i,alias:"symbol",inside:{"short-root":/^\w+(?=\.\.)/,"short-delimiter":/\.\./,"short-field":/\w+$/}},"function-context":{pattern:/[a-z0-9_]+\(.*?\)/i,inside:{}},duration:{pattern:/-?\d+(ns|u|µ|ms|s|m|h|d|w)/i,alias:"number"},builtin:new RegExp("\\b(?:"+pe.map((function(e){return e.text})).join("|")+")(?=\\s*\\()","i"),string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},keyword:/\b(?:and|empty|import|in|not|or|return)\b/,boolean:/\b(?:true|false)\b/,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/-|\+|\*|\/|%|==|<=?|>=?|!=|!~|=~|=|<-|\|>/,punctuation:/[{}[\];(),.:]/};he["function-context"].inside={argument:{pattern:/[a-z0-9_]+(?=:)/i,alias:"symbol"},duration:he.duration,number:he.number,builtin:he.builtin,string:he.string};var me=he;n(25);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ge=function(e){return e.replace(/[{}[\]="(),!~+\-*/^%]/g,"").trim()},ve=function(e){return{text:e}},be=["1m","5m","10m","30m","1h"],Ae="telegraf";var xe=function(e){function t(t){return e.call(this,t.display,ye(t.display),0)||this}return i(t,e),t}(ie),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleTypeahead=fe()((function(){var e=window.getSelection();if(null===e)return null;if(e.anchorNode){var n=e.anchorNode.parentElement;if(null===n)return;if(n.hasAttribute("data-slate-string")&&(n=n.parentElement),null===n)return;if(!n.closest(".slate-query-field")||t.state.value.isBlurred)return;var r=e.getRangeAt(0),i=e.anchorNode.textContent;if(null===i)return;var o=r.startOffset,a=ge(i.substr(0,o)),s=t.state.value.anchorOffset,u=t.state.value.anchorText.text.slice(0,s),l=[],f=n.classList,d=null,p=t.props.defaultDatabase||Ae;if(f.contains("context-range"))d="context-range",l.push({label:"Range vector",items:c(be).map(ve)});else if(f.contains("short-delimiter")||f.contains("short-field")){var h=de(n,".short-root"),m=h&&h.textContent.replace("..",""),y=de(n,".short-field"),g=y&&y.textContent;if(m&&g){var v=function(e,t,n){return n?'from(bucket: "'+e+'")\n  |> filter(fn: (r) => r["_measurement"] == "'+t+'")\n  |> filter(fn: (r) => r["_field"] == "'+n+'")\n  |> range($range)\n  |> limit(n: 1000)':'from(bucket: "'+e+'")\n  |> filter(fn: (r) => r["_measurement"] == "'+t+'")\n  |> range($range)\n  |> limit(n: 1000)'}(m,g,a=a.replace(/\w*\.\./g,""));l.push({label:"Expand",items:[{deleteBackwards:s,text:v}],skipFilter:!0});var b=t.fields&&t.fields[m]&&t.fields[m][g];if(!b)return void t.fetchFields(m,g);d="context-fields",l.push({label:"Fields",items:b})}else if(m){var A=t.measurements&&t.measurements[m];if(!A)return void t.fetchMeasurements(m);a=a.replace(/\w*\.\./g,""),d="context-measurements",l.push({label:"Measurements",items:A})}}else u.match(/(^\s+$)|(\)\s+$)/)?(d="context-operator",l.push({prefixMatch:!0,label:"Operators",items:["|>","<-","+","-","*","/","<",">","<=","=>","==","=~","!=","!~"].map(ve)})):a&&!f.contains("argument")?(d="context-builtin",l.push({prefixMatch:!0,label:"Functions",items:pe})):(""===P.a.serialize(t.state.value)||i.match(/[+\-*/^%]/))&&(d="context-new",l.push({prefixMatch:!0,label:"Templates",items:['from(bucket: "'+p+'") |> range($range) '].map(ve)}),l.push({prefixMatch:!0,label:"Shortcodes",items:[p+".."].map(ve)}));var x=0,k=l.map((function(e){return e.items&&a&&!e.skipFilter&&(e.items=e.items.filter((function(e){return e.text.length>=a.length})),e.prefixMatch?e.items=e.items.filter((function(e){return 0===e.text.indexOf(a)})):e.items=e.items.filter((function(e){return e.text.indexOf(a)>-1}))),x+=e.items.length,e}));t.setState({typeaheadPrefix:a,typeaheadContext:d,typeaheadText:i,suggestions:x>0?k:[]})}else;}),500),t.applyTypeahead=function(e,n){var r=t.state,i=r.typeaheadPrefix,o=r.typeaheadContext,a=r.typeaheadText;void 0!==n.display&&(n=new xe(n));var s=n.text;switch(o){case"context-operator":n.text.endsWith(" ")||(s+=" ");break;case"context-measurements":var u=function(e){void 0===e&&(e=window);var t=e.getSelection();if(!t||!t.anchorNode)return null;var n=t.getRangeAt(0),r=t.anchorNode.textContent;if(null===r)return null;var i=n.startOffset;return r.substr(i,1)}();u||"."===u||(s+="..")}t.resetTypeahead();var l=n.deleteBackwards||i.length,c=ge(a).length-i.length,f=a.indexOf(i),d=i&&(c>0&&f>-1||s===a)?c+f:0;if(s.match(/\n/)){var p=ae(s);return e.deleteBackward(l).deleteForward(d).insertFragment(p).moveForward(0).focus()}return e.deleteBackward(l).deleteForward(d).insertText(s).moveForward(0).focus()},t}return i(t,e),t.prototype.componentDidMount=function(){this.updateMenu()},t.prototype.componentWillReceiveProps=function(e){null!==e.initialQuery&&e.initialQuery!==this.props.initialQuery&&this.setState({value:se(e.initialQuery)})},t.prototype.fetchFields=function(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return n="field_keys("+e+","+t+")",[4,this.request(n)];case 1:return r=i.sent(),this.fields||(this.fields={}),this.fields[e]||(this.fields[e]={}),this.fields[e][t]=r,setTimeout(this.handleTypeahead,0),[2]}}))}))},t.prototype.fetchMeasurements=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t="measurements("+e+")",[4,this.request(t)];case 1:return n=r.sent(),this.measurements||(this.measurements={}),this.measurements[e]=n,setTimeout(this.handleTypeahead,0),[2]}}))}))},t}(le),Ee=function(e){function t(t){var n=e.call(this,t)||this;return n.handleChangeQuery=function(e){var t=n.props,r=t.index,i=t.change,o=n.state.query!==e;n.setState({edited:o,query:e}),i&&i(e,r)},n.handlePressEnter=function(){var e=n.props.execute;e&&e()},n.state={edited:!1,query:t.query||""},n}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.database,n=e.request,r=this.state,i=r.edited,o=r.query;return L.a.createElement("div",{className:"gf-form-input",style:{height:"initial"}},L.a.createElement(ke,{defaultDatabase:t,initialQuery:i?null:o,onPressEnter:this.handlePressEnter,onQueryChange:this.handleChangeQuery,prismLanguage:"flux",prismDefinition:me,placeholder:"Enter a FLUX query",request:n}))},t}(F.Component);U.a.directive("fluxEditor",["reactDirective",function(e){return e(Ee,["change","database","execute","query","request"])}]);var _e=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.onDataReceived=function(e){r.resultRecordCount=e.reduce((function(e,t){return e+("table"===t.type?t.rows.length:t.datapoints.length)}),0),r.resultTableCount=e.length},r.onResponseReceived=function(e){r.dataPreview=e.data},r.onRefresh=function(){r.dataPreview="",r.resultRecordCount="",r.resultTableCount=""},r.onChange=function(e){r.target.query=e},r.onExecute=function(){r.panelCtrl.refresh()},r.requestMetadata=function(e){return r.datasource.metricFindQuery(e)},r.resultRecordCount="",r.resultTableCount="",void 0===r.target.query&&(r.target.query='from(bucket: "'+r.datasource.bucket+'")\n  |> range($range)\n  |> limit(n:1000)\n'),r.defaultBucket=r.datasource.bucket,r.resultFormats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],I.a.on("ds-request-response",r.onResponseReceived,t),r.panelCtrl.events.on("refresh",r.onRefresh,t),r.panelCtrl.events.on("data-received",r.onDataReceived,t),r}return t.$inject=["$scope","$injector"],i(t,e),t.prototype.getCollapsedText=function(){return this.target.query},t.templateUrl="partials/query.editor.html",t}(M.QueryCtrl),we=function(){function e(e){var t=this;this.current.jsonData=this.current.jsonData||{},e.$watch("ctrl.current.url",(function(e){t.save()}))}return e.$inject=["$scope"],e.prototype.save=function(){this.current.jsonData.url=this.current.url},e.templateUrl="partials/config.html",e}();n.d(t,"AnnotationsQueryCtrl",(function(){return Ce})),n.d(t,"Datasource",(function(){return D})),n.d(t,"QueryCtrl",(function(){return _e})),n.d(t,"ConfigCtrl",(function(){return we}));var Ce=function(){function e(){}return e.templateUrl="partials/annotations.editor.html",e}()}])}));